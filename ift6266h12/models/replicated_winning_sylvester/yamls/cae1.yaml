# This scripts learn the first layer
!obj:pylearn2.scripts.train.Train {
    "dataset": !obj:pylearn2.datasets.npy_npz.NpyDataset &dataset {
        "file" : "layers/npy/sylvester_train_pca8.npy" # Should be an N x 300 matrix on disk.
    },
    "model": !obj:pylearn2.autoencoder.ContractiveAutoencoder {
        "nvis" : 8,
        "nhid" : 6,
        "irange" : 0.05,
        "act_enc": "sigmoid", #for some reason only sigmoid function works
        "act_dec": "sigmoid",    
    },
    "algorithm": !obj:pylearn2.training_algorithms.sgd.UnsupervisedExhaustiveSGD {
        "learning_rate" : 1e-3,
        "batch_size" : 10,
        "monitoring_batches" : 5,
        "monitoring_dataset" : *dataset,
        "cost" : [!obj:pylearn2.costs.autoencoder.MeanBinaryCrossEntropy {},
        !obj:pylearn2.costs.autoencoder.ScaleBy { 
          cost: !obj:pylearn2.costs.autoencoder.ModelMethodPenalty {
            method_name: contraction_penalty 
                }, 
                coefficient: 0.5 } ],
        "termination_criterion" : !obj:pylearn2.training_algorithms.sgd.EpochCounter {
            "max_epochs": 2,
        },
    },
    "save_path": "layers/pkl/layer1.pkl",
    "save_freq": 1
}
